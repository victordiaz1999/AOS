openapi: 3.0.2
info:
  title: '️API clientes: especificación de la API para la gestión de cliente'
  description: 'Este subsistema se encargará de las operaciones relacionadas con la gestión integral de clientes del taller. Proporcionará operaciones que permitan dar de alta, modificar y buscar clientes (por diferentes criterios) para el resto del sistema.'
  license:
    name: MIT
    url: 'https://opensource.org/licenses/MIT'
  version: 1.0.0
  contact:
    name: AOS - Equipo6
    
servers:
  - url: 'http://127.0.0.1:80'
    description: Servidor local
    
tags:
  - name: Clientes
    description: Gestión de clientes del taller


components:
  schemas:
    Cliente:
        type: object
        description: cliente registrado
        properties:
          idCliente:
            description: Id cliente
            type: integer
            format: int64
          nif/nie:
            description: Documento de identificación del cliente
            type: string
            pattern: >-
              ((([X-Z])|([LM])){1}([-]?)((\d){7})([-]?)([A-Z]{1}))|((\d{8})([-]?)([A-Z]))
          nombre:
            description: Nombre del cliente
            type: string
          apellidos:
            description: Apellidos del cliente
            type: string
          telefono:
            description: Número de teléfono del cliente
            type: string
            pattern: (?:6[0-9]|7[1-9])[0-9]{7}$
          domicilio:
            description: Dirección del cliente
            type: string
          email:
            description: Correo electrónico del cliente
            type: string
            format: email
          links:
              description: Enlaces 
              type: object
              properties:
                  parent:
                      type: object
                      description: Enlace 
                      properties:
                          href:
                              description: URL del enlace
                              type: string
                              format: url
                              x-faker: internet.url
                          rel:
                              description: "Relación del documento enlazado con el actual. Contiene una lista de tipos
                              de enlaces separados por espacio."
                              type: string
                              x-faker: lorem.words
                  self:
                      type: object
                      description: Enlace de relación
                      properties:
                          href:
                              description: URL del enlace
                              type: string
                              format: url
                              x-faker: internet.url
                          rel:
                              description: "Relación del documento enlazado con el actual. Contiene una lista de tipos
                              de enlaces separados por espacio."
                              type: string
                              x-faker: lorem.words
        example:
          idCliente: 2022
          nif/nie: 52013776-T
          nombre: Francisco José
          apellidos: Morera
          telefono: 666432534
          domicilio: 'C/Tajo, 5, 3ºC'
          email: kikomorera@gmail.com
          links:
              parent:
                href: /clientes
                rel: listaClientes
              self:
                href: /clientes/2022
                rel: modificar
    HTTP_Problem:
        type: object
        externalDocs:
          url: 'https://tools.ietf.org/html/rfc7807'
        description: Problem Details for HTTP APIs
        properties:
          type:
            type: string
            format: uri
            description: 'A URI reference [RFC3986] that identifies the problem type'
          title:
            type: string
            description: short human-readable summary of the problem type
          status:
            type: number
            description: HTTP status code
          detail:
            type: string
            description: >-
              human-readable explanation specific to this occurrence of the
              problem
          instance:
            type: string
            format: uri
            description: >-
              A URI reference that identifies the specific occurrence of the
              problem.  It may or may not yield further information if
              dereferenced
              
headers:
    ETag:
      description: Entity Tag (identificador único proporcionado para validación de caché)
      schema:
        type: string
        pattern: '[0-9a-f]*'
        x-faker: random.uuid
        example: 24f21ae791234aeb
    Location:
      description: '`URI` del nuevo recurso'
      schema:
        type: string
        format: url
        x-faker: internet.url
        example: clientes/133
    Allow:
      description: Métodos HTTP soportados
      schema:
        type: string
      example: 'GET, PUT, OPTIONS'
    
    parameters:
    idCliente:
      name: idCliente
      in: path
      description: ID del cliente
      required: true
      schema:
        type: integer
        pattern: ^\d+$
    nifnie:
      name: nifnie
      in: path
      required: true
      description: NIE o NIF del cliente
      schema:
        type: string
        pattern: >-
          ((([X-Z])|([LM])){1}([-]?)((\d){7})([-]?)([A-Z]{1}))|((\d{8})([-]?)([A-Z]))
    nombre:
      name: nombre
      in: path
      required: true
      description: Nnombre del cliente
      schema:
        type: string
    ifMatchParam:
      name: If-Match
      in: header
      description: ETag del recurso que se desea modificar
      required: true
      schema:
        type: string
        pattern: '[0-9a-f]*'
    
    requestBodies:
    clienteRB:
      description: '`Cliente` data'
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - nif/nie
              - nombre
              - apellidos
              - telefono
              - domicilio
              - email
            properties:
              nif/nie:
                description: Documento de identificación del cliente
                type: string
                pattern: >-
                  ((([X-Z])|([LM])){1}([-]?)((\d){7})([-]?)([A-Z]{1}))|((\d{8})([-]?)([A-Z]))
              nombre:
                description: Nombre del cliente
                type: string
              apellidos:
                description: Apellidos del cliente
                type: string
              telefono:
                description: Número de teléfono del cliente
                type: string
                pattern: (?:6[0-9]|7[1-9])[0-9]{7}$
              domicilio:
                description: Dirección del cliente
                type: string
              email:
                description: Correo electrónico del cliente
                type: string
                format: email
            example:
              nif/nie: 52013776-T
              nombre: Francisco José
              apellidos: Morera
              telefono: 666432534
              domicilio: 'C/Tajo, 5, 3ºC'
              email: kikomorera@gmail.com
    responses:
    Response_404:
      description: '`NOT FOUND`: recurso no disponible'
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/HTTP_Problem'
          examples:
            response-http-404:
              $ref: '#/components/examples/response-http-404'
    Response_412:
      description: '`PRECONDITION FAILED`: no se cumple alguna condición previa'
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/HTTP_Problem'
          examples:
            response-http-412:
              $ref: '#/components/examples/response-http-412'
    Response_422:
      description: '`UNPROCESSABLE ENTITY`: falta algún dato necesario'
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/HTTP_Problem'
          examples:
            response-http-422:
              $ref: '#/components/examples/response-http-422'